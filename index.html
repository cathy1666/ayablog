<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Aya Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  
  <meta property="og:type" content="website">
<meta property="og:title" content="Aya Blog">
<meta property="og:url" content="http://cathy1666.github.io/ayablog/index.html">
<meta property="og:site_name" content="Aya Blog">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Aya Blog">
  
    <link rel="alternate" href="/atom.xml" title="Aya Blog" type="application/atom+xml">
  
  <link rel="icon" href="/ayablog/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/ayablog/css/style.css">

  <script src="/ayablog/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/ayablog/css/bootstrap.css" >
  <link rel="stylesheet" href="/ayablog/css/fashion.css" >
  <link rel="stylesheet" href="/ayablog/css/glyphs.css" >

</head>



  <body>


  


<header id="allheader" class="site-header" role="banner" 
   >
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/ayablog/" title="Aya Blog" rel="home"> Aya Blog </a>
            
          </h1>
          
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows"  style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/ayablog/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/ayablog/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/ayablog/tags">Tags</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/ayablog/about">About</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main">
  
    <article id="post-TOEIC準備心得"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/ayablog/2017/02/06/TOEIC準備心得/">TOEIC準備心得</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/ayablog/2017/02/06/TOEIC準備心得/" class="article-date">
	  <time datetime="2017-02-06T03:11:06.036Z" itemprop="datePublished">February 6, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="短期記憶-與-長期記憶-理論"><a href="#短期記憶-與-長期記憶-理論" class="headerlink" title="短期記憶 與 長期記憶 理論"></a>短期記憶 與 長期記憶 理論</h3><p>忘記一開始是從哪裡看到的背單字方法，但我開始遵循這個理論之後，不但學英文的心理壓力變小，效率也變好，而且這套理論不只適用在背單字，在學習各類知識上都非常有用。</p>
<p>以下截錄自<a href="http://myet.pixnet.net/blog/post/31769968--%E3%80%90%E8%AA%9E%E8%A8%80%E5%AD%B8%E7%BF%92%E3%80%91%E5%AD%B8%E5%96%AE%E5%AD%97%E7%9A%84%E6%96%B9%E6%B3%95" target="_blank" rel="external">【語言學習】學單字的方法</a></p>
<blockquote>
<p>人類的記憶有所謂的<strong>長期記憶（Long-term Memory, LTM）</strong>與<strong>短期記憶（Short-term Memory）</strong>的區別。在長期記憶區裡的知識，會跟隨我們很長一段時間，甚至於一輩子；而在短期記憶區內的知識，很快就會被遺忘。想要有效的學習英文單字，最重要的就是要讓英文單字進入你的長期記憶區。</p>
<p>而要讓一個英文單字進入長期記憶區，基本上有兩種策略：第一增是增加記憶的強度，第二是採用有系統的重複學習，也就是所謂的<strong>「間格重複」（Spaced Repetition）</strong>的技巧。</p>
</blockquote>
<p>所謂的「間格重複」技巧，白話的解釋就是<strong>短時間內重複看到很多次</strong>，其實也是很簡單的技巧，但我們要做的就是，每隔一段時間就回頭檢視一下自己的學習方式是否有真正的實踐「短時間內多次複習」這件事。</p>
<p>記住，<strong>匆匆讀過很多遍</strong>絕對比<strong>仔細讀過一遍</strong>更容易加深記憶！</p>
<h3 id="單字"><a href="#單字" class="headerlink" title="單字"></a>單字</h3><p>我個人的心得是，不要<strong>特地</strong>去背單字。<br>特地是指買一本單字書從頭背到尾，我以前也買過很多口袋單字本，或是前面是字典後面有單句練習題那種，但真的效率很差，不只是壓力很大無法持續，而且很快就忘了。<br>針對準備TOEIC，我現在都是從題目裡去背單字，大概寫個完整的五回模擬試題(回數可能看自己原本的單字量會有差異)，就會有感覺TOEIC會出的單字就那些，不但練到題目也背到單字，一舉多得!<br>而且現在買到的題庫都有設計過，在同一回測驗裡的不同文章會重複用到特定的幾個單字，也可達到<strong>「短時間內多次複習」</strong>的效果。</p>
<h3 id="文法"><a href="#文法" class="headerlink" title="文法"></a>文法</h3><p>推薦這本 <a href="http://www.books.com.tw/products/0010483241" target="_blank" rel="external">NEW TOEIC TEST金色證書-文法</a>，這本的優點就是很薄，只講重點文法，而且是用很有邏輯的方式解說，而不是叫你死背。<br>看完這本其他需要特別背的瑣碎文法就在寫模擬測驗時遇到再記就好。</p>
<h3 id="聽力"><a href="#聽力" class="headerlink" title="聽力"></a>聽力</h3><p>我目前試過最有效的方法是看美劇，因為同一部美劇內的角色習慣的說話方式，才能<strong>重複複習同個領域的用詞</strong>，加深記憶，如果是看很多部不同的電影可能就沒有這種效果。<br>有人推薦<a href="http://mrguoyi.pixnet.net/blog/post/12930046-%E9%83%AD%E6%98%93%E8%80%81%E5%B8%AB%E8%AB%96%E2%97%8E%E5%88%A9%E7%94%A8%E8%8B%B1%E7%BE%8E%E5%BD%B1%E9%9B%86%E9%9B%BB%E5%BD%B1%E5%AD%B8%E8%8B%B1%E6%96%87%E4%B9%8B%E3%80%8C%E4%B8%AD" target="_blank" rel="external">中英無三遍法學習法</a>，但我自己很不喜歡同樣的內容看第二次，所以就是找集數很多的美劇，可以的話再搭配中英同時顯示的字幕。</p>
<p>挑美劇的重點:</p>
<ul>
<li>很多季，集數多，但每集短(約20min)</li>
<li>針對TOEIC愛考的題型，挑職場類或生活化的劇</li>
<li>自己有興趣的內容，才能不由自主一直看下去，當消遣同時也練英聽</li>
</ul>
<p>我個人推薦How I Met Your Mother(共9季)和Drop Dead Diva(共6季)，輕鬆好笑可以一集接一集，另外還有Friends(共10季)也是很多人推薦練英聽的好劇。</p>
<h3 id="閱讀"><a href="#閱讀" class="headerlink" title="閱讀"></a>閱讀</h3><p>針對TOEIC題型的答題技巧很多人都寫過了，所以我這邊就直接提供我覺得不錯的文章連結:</p>
<ul>
<li><a href="https://www.ptt.cc/bbs/TOEIC/M.1350067481.A.B3C.html" target="_blank" rel="external">[心得] 落落長的心得文 940 495/445</a></li>
<li><a href="http://b.bbi.com.tw/TOEIC/1Godtg8w.html" target="_blank" rel="external">[心得] 一個月 TOEIC 845-&gt;950 </a></li>
</ul>
<p>再來就是寫題庫，寫題庫，寫題庫!!!<br>並且盡量寫完後在一兩天內訂正完，才能達到從短期記憶轉變為長期記憶的效果。<br>一開始會錯很多，訂正會很痛苦，但一定要認真訂正，不然一直錯一樣的地方反而會把錯的選項越記越牢喔。</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>灰心喪志時可以多看PTT TOEIC版，多看看別人分享的心得及讀書技巧，會發現大家都是這麼走過來的，可以重新燃起鬥志喔!!<br>我也是準備後期才發現這個版的，有種相見恨晚的感覺。</p>
<blockquote>
<p>PTT TOEIC版：主選單&gt;分組討論區&gt;國家研究院&gt;語言研究院&gt;TOEIC</p>
</blockquote>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/ayablog/tags/心得/">心得</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-不定長度引數function寫法"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/ayablog/2017/01/10/不定長度引數function寫法/">不定長度引數函數的寫法</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/ayablog/2017/01/10/不定長度引數function寫法/" class="article-date">
	  <time datetime="2017-01-10T09:21:51.599Z" itemprop="datePublished">January 10, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><p>把開 特定檔案、寫入帶有當下時間的log、關檔案 整個流程寫成一個function，且此function要有像printf的介面，可以自動偵測印出含有任意數量的變數的string。</p>
<h3 id="Sample-Code"><a href="#Sample-Code" class="headerlink" title="Sample Code"></a>Sample Code</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">printLog</span><span class="params">(<span class="keyword">char</span>* hex, <span class="keyword">int</span> len, <span class="keyword">char</span>* char_p, ...)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> i;</div><div class="line">	FILE *fp;</div><div class="line">	<span class="keyword">unsigned</span> <span class="keyword">char</span>* hex_p = (<span class="keyword">unsigned</span> <span class="keyword">char</span>*)hex;</div><div class="line"></div><div class="line">	fp = fopen(LOGFILE, <span class="string">"a"</span>);</div><div class="line">	<span class="keyword">if</span> (<span class="literal">NULL</span> == fp)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"open %s fail\n"</span>, LOGFILE);</div><div class="line">		<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">	&#125;	</div><div class="line">	</div><div class="line">	<span class="keyword">char</span> buffer[<span class="number">256</span>];</div><div class="line">	va_list list_p;</div><div class="line">	va_start(list_p, char_p);</div><div class="line">	<span class="built_in">vsprintf</span>(buffer, char_p, list_p);</div><div class="line">	va_end(list_p);</div><div class="line">	</div><div class="line">	<span class="comment">//print time stamp</span></div><div class="line">	<span class="built_in">fprintf</span>(fp, <span class="string">"%.24s   "</span>, getTime()); </div><div class="line">	</div><div class="line">	<span class="comment">//print comment with variable-length argument </span></div><div class="line">	<span class="built_in">fprintf</span>(fp, <span class="string">"%s"</span>, buffer);</div><div class="line"></div><div class="line">	<span class="comment">//print hex string	</span></div><div class="line">	<span class="built_in">fprintf</span>(fp, <span class="string">"[ "</span>);</div><div class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">fprintf</span>(fp, <span class="string">"%02x "</span>, *hex_p++);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">fprintf</span>(fp, <span class="string">"]\n"</span>);</div><div class="line">	</div><div class="line">	fclose(fp);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>這段code是reference內sample code變化應用，想知道細節就參考reference吧，裡面寫得很詳細!</p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="http://ccd9527.blogspot.tw/2009/04/cc-variable-length-argument.html" target="_blank" rel="external">C/C++ : 不定長度引數（Variable-length argument）</a></p>
<p><a href="http://www.programmer-club.com.tw/ShowSameTitleN/c/33173.html" target="_blank" rel="external">請問像printf()這樣參數數量不固定的函數如何實作? </a></p>
<p><a href="http://www.cplusplus.com/reference/cstdio/vsprintf/" target="_blank" rel="external">vsprintf</a></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/ayablog/tags/C-C/">C/C++</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-如何使用 pthread_create 傳遞多個引數"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/ayablog/2017/01/10/如何使用 pthread_create 傳遞多個引數/">如何使用 pthread_create 傳遞多個引數</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/ayablog/2017/01/10/如何使用 pthread_create 傳遞多個引數/" class="article-date">
	  <time datetime="2017-01-10T01:32:36.719Z" itemprop="datePublished">January 10, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="函數定義"><a href="#函數定義" class="headerlink" title="函數定義"></a>函數定義</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">#include &lt;pthread.h&gt;</div><div class="line">int pthread_create( pthread_t *thread, </div><div class="line">					const pthread_attr_t *attr, </div><div class="line">					void *(*start_routine) (void *),</div><div class="line">					void *arg);</div></pre></td></tr></table></figure>
<ul>
<li><strong>pthread_t *thread</strong> 為pthread的指標，在使用thread之前必須要先宣告一個pthread_t的變數。</li>
<li><strong>const pthread_attr_t *attr</strong> 為一個structure指標，內含創建此thread的屬性，預設是NULL，如果沒有其他特殊的需求直接填入NULL即可。</li>
<li><strong>void *(*start_routine) (void *)</strong> 為function pointer，即所創建的thread要執行的handler function。</li>
<li><strong>void *arg</strong> 為Function pointer所指function要帶的參數,需為指標型態。</li>
<li><strong>RETURN VALUE:</strong> 如果執行成功則回傳0，如果執行失敗則回傳錯誤代碼。</li>
</ul>
<h3 id="EX"><a href="#EX" class="headerlink" title="EX:"></a>EX:</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">print_data</span><span class="params">(<span class="keyword">void</span> *data)</span></span>;</div><div class="line">...</div><div class="line"><span class="keyword">pthread_t</span> t1;</div><div class="line"><span class="keyword">int</span> arg1 = <span class="number">5</span>;</div><div class="line">pthread_create( &amp;t1, <span class="literal">NULL</span> , print_data , (<span class="keyword">void</span> *)&amp;arg1);</div><div class="line"></div><div class="line">pthread_create( &amp;t1, <span class="literal">NULL</span> , (<span class="keyword">void</span> *)print_data , (<span class="keyword">void</span> *)&amp;arg1);</div></pre></td></tr></table></figure>
<h3 id="傳遞一個引數"><a href="#傳遞一個引數" class="headerlink" title="傳遞一個引數"></a>傳遞一個引數</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">print_data</span><span class="params">(<span class="keyword">void</span> *data)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="comment">//printf("data = %d\n", *data);//compile不會過</span></div><div class="line"></div><div class="line">	<span class="keyword">int</span> tt = *(<span class="keyword">int</span>*)data;</div><div class="line"></div><div class="line">	<span class="built_in">printf</span>(<span class="string">"print_data START\n"</span>);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"data = %d\n"</span>, tt);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"print_data END\n"</span>);</div><div class="line"></div><div class="line">	pthread_exit(<span class="literal">NULL</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> arg1 = <span class="number">88</span>;</div><div class="line">	<span class="keyword">pthread_t</span> t1;</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (pthread_create(&amp;t1, <span class="literal">NULL</span>, print_data, (<span class="keyword">void</span> *)&amp;arg1) != <span class="number">0</span>)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"create thread fail: %s\n"</span>, strerror(errno));</div><div class="line">	&#125;</div><div class="line">	sleep(<span class="number">5</span>); <span class="comment">//避免thread還沒執行完main就結束</span></div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>(void *)指標型態的參數傳進function後，需要先指定是甚麼型態的指標才能使用，直接使用指標指向的值，compiler無法判斷要讀多長的記憶體空間，所以連compile都不會過:</p>
<h3 id="Compile-Error"><a href="#Compile-Error" class="headerlink" title="Compile Error:"></a>Compile Error:</h3><pre><code>warning: dereferencing &apos;void *&apos; pointer [enabled by default]
error: invalid use of void expression
</code></pre><h3 id="傳遞多個引數"><a href="#傳遞多個引數" class="headerlink" title="傳遞多個引數"></a>傳遞多個引數</h3><p>pthread_create的函數定義裡，只有一個欄位可以放傳入handler function的引數，所以要傳遞多個引數時，可以把需要的引數包成一個structure，再將此structure的pointer作為引數傳入。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> testdata</div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> num;</div><div class="line">	<span class="keyword">char</span> name[<span class="number">10</span>];</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">print_data</span><span class="params">(<span class="keyword">void</span> *data)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">struct</span> testdata* tt = (<span class="keyword">struct</span> testdata*)data;</div><div class="line"></div><div class="line">	<span class="built_in">printf</span>(<span class="string">"print_data START\n"</span>);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"num = %d\n"</span>, tt-&gt;num);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"name = %s\n"</span>, tt-&gt;name);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"print_data END\n"</span>);</div><div class="line"></div><div class="line">	pthread_exit(<span class="literal">NULL</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">struct</span> testdata data1;</div><div class="line">	<span class="keyword">pthread_t</span> t1;</div><div class="line"></div><div class="line">	data1.num = <span class="number">100</span>;</div><div class="line">	<span class="built_in">strcpy</span>(data1.name, <span class="string">"Hello"</span>);</div><div class="line">	</div><div class="line">	<span class="keyword">if</span> (pthread_create( &amp;t1, <span class="literal">NULL</span> , print_data , (<span class="keyword">void</span> *)&amp;data1) != <span class="number">0</span>)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"create thread fail: %s\n"</span>, strerror(errno));</div><div class="line">	&#125;</div><div class="line">	sleep(<span class="number">5</span>); <span class="comment">//避免thread還沒執行完main就結束</span></div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="pass-by-reference引起的segmentation-fault"><a href="#pass-by-reference引起的segmentation-fault" class="headerlink" title="pass by reference引起的segmentation fault"></a>pass by reference引起的segmentation fault</h3><p>因為受限於pthread_create本身的定義，pthread_create所有的參數都是使用指標，也就是用pass by reference的方式傳遞引數，所以就要特別注意reference的位置是否為NULL，會不會造成segmentation fault。<br>以下例子就是我自己寫multi-thread程式的血淚經驗中得來的:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> testdata</div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> num;</div><div class="line">	<span class="keyword">char</span> name[<span class="number">10</span>];</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">print_data</span><span class="params">(<span class="keyword">void</span> *data)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">struct</span> testdata* tt = (<span class="keyword">struct</span> testdata*)data;</div><div class="line"></div><div class="line">	<span class="built_in">printf</span>(<span class="string">"print_data START\n"</span>);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"num = %d\n"</span>, tt-&gt;num);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"name = %s\n"</span>, tt-&gt;name);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"print_data END\n"</span>);</div><div class="line"></div><div class="line">	pthread_exit(<span class="literal">NULL</span>);</div><div class="line">&#125;	</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">struct</span> testdata data1;</div><div class="line">	<span class="keyword">pthread_t</span> t1;</div><div class="line"></div><div class="line">	data1.num = <span class="number">100</span>;</div><div class="line">	<span class="built_in">strcpy</span>(data1.name, <span class="string">"Hello"</span>);</div><div class="line">	</div><div class="line">	<span class="keyword">if</span> (pthread_create( &amp;t1, <span class="literal">NULL</span> , print_data , (<span class="keyword">void</span> *)&amp;data1) != <span class="number">0</span>)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"create thread fail: %s\n"</span>, strerror(errno));</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	func();</div><div class="line">	</div><div class="line">	sleep(<span class="number">5</span>); <span class="comment">//避免thread還沒執行完main就結束</span></div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="OUTPUT"><a href="#OUTPUT" class="headerlink" title="OUTPUT"></a>OUTPUT</h3><pre><code>print_data START
num = -6947704
name = ��y���Z�u
print_data END
</code></pre><p>以上程式有很大的機率會在執行時發生segmentation fault，原因是傳入的引數data1是定義在func()內，func()一結束區域變數data1就會被系統清除，而此時thread進行到<br><code>printf(&quot;num = %d\n&quot;, tt-&gt;num);</code><br>這行時，就會讀錯記憶體區塊，造成segmentation fault。</p>
<h3 id="解決方法"><a href="#解決方法" class="headerlink" title="解決方法"></a>解決方法</h3><p>雖然所有pthread_create的動作都在main進行是最安全的作法，但程式越來越大，為了使程式結構化寫成function還是有必要的。所以我目前的解法是在thread handler function內一開始就把傳入指標指向的值copy一份，另外在pthread_create後也稍微delay確保copy引數值的動作完成才結束func()。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">struct</span> testdata</div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> num;</div><div class="line">	<span class="keyword">char</span> name[<span class="number">10</span>];</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> *<span class="title">print_data</span><span class="params">(<span class="keyword">void</span> *data)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">struct</span> testdata tt = *(<span class="keyword">struct</span> testdata*)data; <span class="comment">// 直接copy值，而不是用reference的方法使用</span></div><div class="line"></div><div class="line">	<span class="built_in">printf</span>(<span class="string">"print_data START\n"</span>);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"num = %d\n"</span>, tt.num);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"name = %s\n"</span>, tt.name);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"print_data END\n"</span>);</div><div class="line"></div><div class="line">	pthread_exit(<span class="literal">NULL</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">struct</span> testdata data1;</div><div class="line">	<span class="keyword">pthread_t</span> t1;</div><div class="line"></div><div class="line">	data1.num = <span class="number">100</span>;</div><div class="line">	<span class="built_in">strcpy</span>(data1.name, <span class="string">"Hello"</span>);</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (pthread_create(&amp;t1, <span class="literal">NULL</span>, print_data, (<span class="keyword">void</span> *)&amp;data1) != <span class="number">0</span>)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"create thread fail: %s\n"</span>, strerror(errno));</div><div class="line">	&#125;</div><div class="line">	usleep(<span class="number">500000</span>);<span class="comment">//確保copy引數值的動作完成才結束func()</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	func();</div><div class="line"></div><div class="line">	sleep(<span class="number">5</span>); <span class="comment">//避免thread還沒執行完main就結束</span></div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="OUTPUT-1"><a href="#OUTPUT-1" class="headerlink" title="OUTPUT"></a>OUTPUT</h3><pre><code>print_data START
num = 100
name = Hello
print_data END
</code></pre><p>當然，這不是最好的做法，畢竟做了delay，如果有發現更好的做法再來更新吧!</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/ayablog/tags/C-C/">C/C++</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/ayablog/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/ayablog/tags/pthread/">pthread</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-如何外部終止特定執行緒"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/ayablog/2017/01/05/如何外部終止特定執行緒/">如何外部終止特定執行緒</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/ayablog/2017/01/05/如何外部終止特定執行緒/" class="article-date">
	  <time datetime="2017-01-05T01:46:25.748Z" itemprop="datePublished">January 5, 2017</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><p>主程式會不定時創建 5 個執行緒執行工作A~E, 當主程式需執行A工作時，需先判斷上一輪的A是否結束，若還沒結束就需先強制終止掉正在進行A的執行緒後，再創建一個新的執行緒執行這次的工作A。</p>
<h3 id="問題"><a href="#問題" class="headerlink" title="問題"></a>問題</h3><p>使用pthread_cancel()來外部終止執行緒是以pthread_id來識別，但pthread_id是類似file descriptor的識別碼，只要空了就可以重複使用，所以有可能上一輪的A已經結束，而此pthread_id被後來創建的執行緒C拿去用。所以用pthread_id在多執行緒的環境中無法識別執行特定工作的執行緒是否還沒結束，也就是說，用pthread_cancel()可能會終止掉非目標的執行緒，造成程式錯誤。</p>
<h3 id="解法"><a href="#解法" class="headerlink" title="解法"></a>解法</h3><p>不使用pthread_id來識別執行緒，而是自己定義一個陣列記錄每個執行緒目前的狀態。但此陣列可能同時被多個執行緒存取，造成race condition, 所以需再加上mutex做保護。</p>
<h3 id="Sameple-code"><a href="#Sameple-code" class="headerlink" title="Sameple code"></a>Sameple code</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;pthread.h&gt;</span></span></div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DEV_MAX 5</span></div><div class="line"><span class="keyword">volatile</span> <span class="keyword">int</span> SendTrigThreadStop[DEV_MAX] = &#123; <span class="number">0</span> &#125;;</div><div class="line"><span class="keyword">pthread_mutex_t</span> TrigStopMutex[DEV_MAX];</div><div class="line"><span class="keyword">pthread_t</span> thread_SendTrigMsg[DEV_MAX];</div><div class="line"></div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">void</span> *<span class="title">func</span><span class="params">(<span class="keyword">void</span> *param)</span></span></div><div class="line">	&#123;	</div><div class="line">		<span class="comment">//pthread_detach(pthread_self());</span></div><div class="line">		<span class="comment">//在pthread_create後，在thread function中pthread_detach自己,資源在thread function退出時或調用pthread_exit()時會自動被釋放</span></div><div class="line">		<span class="comment">//加了這行就不能被join了</span></div><div class="line">		</div><div class="line">	</div><div class="line">		<span class="keyword">int</span> num = (<span class="keyword">int</span>)param;</div><div class="line">		<span class="keyword">long</span> <span class="keyword">long</span> <span class="keyword">int</span> count = <span class="number">0</span>;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"thread %d begin...\n"</span>, num);</div><div class="line">	</div><div class="line">	</div><div class="line">		<span class="keyword">while</span> (getTrigThreadStat(num) == <span class="number">0</span>)</div><div class="line">		&#123;</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"thread[%d]: %d\n"</span>, num, count++);</div><div class="line">			sleep(<span class="number">1</span>);</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"thread %d end...\n"</span>, num);</div><div class="line">		</div><div class="line">		pthread_exit(<span class="literal">NULL</span>);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getTrigThreadStat</span><span class="params">(<span class="keyword">int</span> dev_n)</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">	</div><div class="line">			pthread_mutex_lock(&amp;TrigStopMutex[dev_n]);</div><div class="line">			ret = SendTrigThreadStop[dev_n];</div><div class="line">			pthread_mutex_unlock(&amp;TrigStopMutex[dev_n]);</div><div class="line">	</div><div class="line">		<span class="keyword">return</span> ret;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">setTrigThreadStat</span><span class="params">(<span class="keyword">int</span> dev_n, <span class="keyword">int</span> val)</span></span></div><div class="line">	&#123;</div><div class="line">			pthread_mutex_lock(&amp;TrigStopMutex[dev_n]);</div><div class="line">			SendTrigThreadStop[dev_n] = val;</div><div class="line">			pthread_mutex_unlock(&amp;TrigStopMutex[dev_n]);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> i;</div><div class="line">		<span class="keyword">int</span> thread_n = <span class="number">3</span>;</div><div class="line">		<span class="comment">// start thread</span></div><div class="line">		<span class="keyword">if</span> (pthread_create(&amp;thread_SendTrigMsg[thread_n], <span class="literal">NULL</span>, func, (<span class="keyword">void</span>*)thread_n)) </div><div class="line">		&#123;</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"pthread_create %d error\n"</span>, thread_n);</div><div class="line">			<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">		&#125;</div><div class="line">	</div><div class="line">		sleep(<span class="number">5</span>);</div><div class="line">	</div><div class="line">	</div><div class="line">		setTrigThreadStat(thread_n, <span class="number">1</span>);</div><div class="line">		pthread_join(thread_SendTrigMsg[thread_n], <span class="literal">NULL</span>);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"main canceled thread %d\n\n"</span>, thread_n);</div><div class="line">		setTrigThreadStat(thread_n, <span class="number">0</span>);</div><div class="line">	</div><div class="line">		thread_n = <span class="number">1</span>;</div><div class="line">		<span class="keyword">if</span> (pthread_create(&amp;thread_SendTrigMsg[thread_n], <span class="literal">NULL</span>, func, (<span class="keyword">void</span>*)thread_n))</div><div class="line">		&#123;</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"pthread_create %d error\n"</span>, thread_n);</div><div class="line">			<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">		&#125;</div><div class="line">	</div><div class="line">		sleep(<span class="number">8</span>);</div><div class="line">	</div><div class="line">		setTrigThreadStat(thread_n, <span class="number">1</span>);</div><div class="line">		pthread_join(thread_SendTrigMsg[thread_n], <span class="literal">NULL</span>);</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"main canceled thread %d\n\n"</span>, thread_n);</div><div class="line">		setTrigThreadStat(thread_n, <span class="number">0</span>);</div><div class="line">	</div><div class="line">		<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p><a href="http://stackoverflow.com/questions/18826853/how-to-stop-a-running-pthread-thread" target="_blank" rel="external">How to stop a running pthread thread?</a></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/ayablog/tags/C-C/">C/C++</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/ayablog/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/ayablog/tags/pthread/">pthread</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  
    <article id="post-如何讓VM開機自動執行"  class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      <a class="article-title" href="/ayablog/2016/12/23/如何讓VM開機自動執行/">讓Virtualbox 的虛擬機器在 Windows 開機後自動啟動</a>
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/ayablog/2016/12/23/如何讓VM開機自動執行/" class="article-date">
	  <time datetime="2016-12-22T16:00:00.000Z" itemprop="datePublished">December 23, 2016</time>
	</a>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><p>有一個在linux環境執行的server,以VM的方式架在Windows的PC上，所以希望PC開完機後自動執行此VM。</p>
<h3 id="操作步驟如下："><a href="#操作步驟如下：" class="headerlink" title="操作步驟如下："></a>操作步驟如下：</h3><h3 id="1-查看虛擬機器名稱"><a href="#1-查看虛擬機器名稱" class="headerlink" title="1. 查看虛擬機器名稱"></a>1. 查看虛擬機器名稱</h3><p>開啟Oracle VM VirtualBox，確認虛擬機器名稱，在此例中虛擬機器叫做 “server_VM”</p>
<img src="/ayablog/2016/12/23/如何讓VM開機自動執行/VM_start_01.jpg" alt="VM_start_01.jpg" title="">
<p>另外也可以用command line的方式查詢(以後可寫成script檔)</p>
<pre><code>開啟命令提示字元
進入安裝Oracle VM VirtualBox資料夾
輸入指令 VBoxManage list vms
</code></pre><img src="/ayablog/2016/12/23/如何讓VM開機自動執行/VM_start_02.jpg" alt="VM_start_02.jpg" title="">
<h3 id="2-建立bat檔"><a href="#2-建立bat檔" class="headerlink" title="2. 建立bat檔"></a>2. 建立bat檔</h3><p>用notepad.exe建立一個副檔名為 bat 的檔案，然後將下面這一行指令給放進去。</p>
<pre><code>VBoxManage startvm server_VM
</code></pre><img src="/ayablog/2016/12/23/如何讓VM開機自動執行/VM_start_03.jpg" alt="VM_start_03.jpg" title="">
<h3 id="3-將-bat-檔放到「啟動」資料夾"><a href="#3-將-bat-檔放到「啟動」資料夾" class="headerlink" title="3. 將 bat 檔放到「啟動」資料夾"></a>3. 將 bat 檔放到「啟動」資料夾</h3><p>每台電腦的「啟動」資料夾路徑可能不同，但win7可以從「開始」功能表找到「啟動」資料夾</p>
<pre><code>開始&gt;&gt; 所有程式&gt;&gt; 啟動&gt;&gt; 右鍵&gt;&gt; 開啟
</code></pre><p>然後直接把準備好的bat檔放進去即可。</p>
<img src="/ayablog/2016/12/23/如何讓VM開機自動執行/VM_start_04.jpg" alt="VM_start_04.jpg" title="">
<img src="/ayablog/2016/12/23/如何讓VM開機自動執行/VM_start_05.jpg" alt="VM_start_05.jpg" title="">

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/ayablog/tags/Windows/">Windows</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/ayablog/tags/小技巧/">小技巧</a></li></ul>

      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
</article>

<!-- Table of Contents -->

  


</section>
          <aside id="sidebar">
  
    <div style="margin: 20px 0;">
	<div id="search-form-wrap">

    <form class="search-form">
        <label style="width: 72%;">
            <span class="screen-reader-text">Search for:</span>
            <input type="search" class="search-field" style="height: 36px; width: 100%;" placeholder=" Search…" value="" name="s" title="Search for:">
        </label>
        <input type="submit" class="search-form-submit" value="Search">
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..."/>
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/ayablog/',
        CONTENT_URL: '/ayablog/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/ayablog/js/insight.js"></script>

</div>
</div>
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Connect With Us</h3>
    <div class="widget widget_athemes_social_icons">

    	<ul class="clearfix widget-social-icons">   
    	
   			<li><a href="https://github.com/cathy1666" title="Github"><i class="fa fa-github" aria-hidden="true"></i></a></li> 

   		
   		</ul>


   		<!--
   		<ul class="clearfix widget-social-icons">   		
   		<li class="widget-si-twitter"><a href="http://twitter.com" title="Twitter"><i class="ico-twitter"></i></a></li> 
		<li class="widget-si-facebook"><a href="http://facebook.com" title="Facebook"><i class="ico-facebook"></i></a></li>
			<li class="widget-si-gplus"><a href="http://plus.google.com" title="Google+"><i class="ico-gplus"></i></a></li>
			<li class="widget-si-pinterest"><a href="http://pinterest.com" title="Pinterest"><i class="ico-pinterest"></i></a></li>
			<li class="widget-si-flickr"><a href="http://flickr.com" title="Flickr"><i class="ico-flickr"></i></a></li>
			<li class="widget-si-instagram"><a href="http://instagram.com" title="Instagram"><i class="ico-instagram"></i></a></li>
		</ul> -->

    </div>
  </div>


  
    
  <div class="widget_athemes_tabs">
    <ul id="widget-tab" class="clearfix widget-tab-nav">
      <li class="active"><a>Recent Posts</a></li>
    </ul>
    <div class="widget">
      <ul>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/ayablog/2017/02/06/TOEIC準備心得/">TOEIC準備心得</a></h6>
              <span>February 6, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/ayablog/2017/01/10/不定長度引數function寫法/">不定長度引數函數的寫法</a></h6>
              <span>January 10, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/ayablog/2017/01/10/如何使用 pthread_create 傳遞多個引數/">如何使用 pthread_create 傳遞多個引數</a></h6>
              <span>January 10, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/ayablog/2017/01/05/如何外部終止特定執行緒/">如何外部終止特定執行緒</a></h6>
              <span>January 5, 2017</span>
            </div>

          </li>
        
          <li class="clearfix">

            
              <div class="widget-entry-summary" style="margin: 0;">
            

              <h6 style="margin: 0;"><a href="/ayablog/2016/12/23/如何讓VM開機自動執行/">讓Virtualbox 的虛擬機器在 Windows 開機後自動啟動</a></h6>
              <span>December 23, 2016</span>
            </div>

          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/ayablog/tags/C-C/">C/C++</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/ayablog/tags/Linux/">Linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/ayablog/tags/Windows/">Windows</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/ayablog/tags/pthread/">pthread</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/ayablog/tags/小技巧/">小技巧</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/ayablog/tags/心得/">心得</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/ayablog/tags/C-C/" style="font-size: 20px;">C/C++</a> <a href="/ayablog/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/ayablog/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/ayablog/tags/pthread/" style="font-size: 15px;">pthread</a> <a href="/ayablog/tags/小技巧/" style="font-size: 10px;">小技巧</a> <a href="/ayablog/tags/心得/" style="font-size: 10px;">心得</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>

    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/ayablog/archives/2017/02/">February 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/ayablog/archives/2017/01/">January 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/ayablog/archives/2016/12/">December 2016</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/ayablog/" class="mobile-nav-link">Home</a>
  
    <a href="/ayablog/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/ayablog/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/ayablog/about" class="mobile-nav-link">About</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2017 Aya Blog All Rights Reserved.
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hipaper" target="_blank">hipaper</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/ayablog/fancybox/jquery.fancybox.css">
  <script src="/ayablog/fancybox/jquery.fancybox.pack.js"></script>


<script src="/ayablog/js/script.js"></script>
<script src="/ayablog/js/bootstrap.js"></script>
<script src="/ayablog/js/main.js"></script>





  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
  

  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>


</body>
</html>
